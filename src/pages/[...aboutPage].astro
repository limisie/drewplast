---
import { getLocalizedDataByEntry, getPageData } from "@lib/data";
import { defaultLocale, locales } from "@i18n/ui";
import { getLocaleUrl } from "@i18n/urls";

import MainLayout from "@layouts/MainLayout.astro";
import EmployeesCardList from "@components/EmployeesCardList.astro";
import FeaturesList from "@components/FeaturesList.astro";
import ImageBanner from "@components/ImageBanner.astro";
import MilestonesTabs from "@components/MilestonesTabs.astro";
import SectionGeneric from "@components/SectionGeneric.astro";
import SectionHeader from "@components/SectionHeader.astro";

export async function getStaticPaths() {
  const data = await getPageData("o-firmie");

  return locales.map((locale) => ({
    params: {
      aboutPage: getLocaleUrl(locale, data[locale].seo.slug),
    },
    props: {
      seo: data[locale].seo,
      sectionHeader: data[locale].sectionHeader,
      sectionDescription: data[locale].sectionDescription,
      sectionEmployees: data[locale].sectionEmployees,
      sectionHistory: data[locale].sectionHistory,
      sectionSustainable: data[locale].sectionSustainable,
    },
  }));
}

const {
  seo,
  sectionHeader,
  sectionDescription,
  sectionEmployees,
  sectionHistory,
  sectionSustainable,
} = Astro.props;
const locale = Astro.currentLocale || defaultLocale;

const { sectionIds: translations } = await getLocalizedDataByEntry(
  { id: "ui", collection: "translations" },
  locale
);
---

<MainLayout seo={seo}>
  <SectionHeader
    title={sectionHeader.title}
    description={sectionHeader.description}
    eyebrow={sectionHeader.eyebrow}
  >
    <ImageBanner image={sectionHeader.image} />
  </SectionHeader>

  <SectionGeneric
    class={{
      content: "content--description",
    }}
    title={sectionDescription.title}
    description={sectionDescription.description}
  />

  <SectionGeneric
    class={{
      section: "full-width light",
      content: "breakout--right",
    }}
    title={sectionEmployees.title}
  >
    <EmployeesCardList employeesList={sectionEmployees.employeesList} />
  </SectionGeneric>

  <SectionGeneric title={sectionHistory.title}>
    <MilestonesTabs milestonesList={sectionHistory.milestonesList} />
  </SectionGeneric>

  <SectionGeneric
    title={sectionSustainable.title}
    id={translations.sustainable}
  >
    <ImageBanner image={sectionSustainable.image} />
    <FeaturesList featuresList={sectionSustainable.featuresList} />
  </SectionGeneric>
</MainLayout>
