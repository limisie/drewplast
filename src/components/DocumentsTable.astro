---
import { defaultLocale } from "@i18n/ui";
import { getLocalizedDataByEntries, getLocalizedDataByEntry } from "@lib/data";

import Table from "@components/Table.astro";
import DocumentTableRow from "@components/DocumentTableRow.astro";

const { documents } = Astro.props;
const locale = Astro.currentLocale || defaultLocale;

const {
  tableHeadings,
  documentsError,
  downloadButtonText,
  archivedLabel,
} = await getLocalizedDataByEntry(
  { id: "documents", collection: "translations" },
  locale
);

const documentsData = await getLocalizedDataByEntries(documents, locale);
const headingsList = tableHeadings.split(",");
---

{
  documentsData.length ? (
    <Table headingsList={headingsList}>
      {documentsData.map((documentData) => (
        <DocumentTableRow
          data={documentData}
          buttonText={downloadButtonText}
          archivedLabel={archivedLabel}
        />
      ))}
    </Table>
  ) : (
    <p>{documentsError}</p>
  )
}
