---
import { getLocalizedDataByEntry } from "@lib/data";
import { defaultLocale } from "@i18n/ui";

import SectionGeneric from "@components/SectionGeneric.astro";
import ElementDetails from "@components/ElementDetails.astro";

const { pipesList } = Astro.props;
const locale = Astro.currentLocale || defaultLocale;

const pipesData = await Promise.all(
  pipesList.map(async ({ pipe, link }) => ({
    data: await getLocalizedDataByEntry(pipe, locale),
    link: link,
  }))
);
---

{
  pipesData.map(({ data, link }) => (
    <SectionGeneric title={data.title} id={link.url}>
      <ElementDetails element={data} />
    </SectionGeneric>
  ))
}
